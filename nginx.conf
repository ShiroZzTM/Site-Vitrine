server {
  listen 80;
  listen [::]:80;
  server_name _;

  # Racine du site (HTML/CSS/JS/Images)
  root /usr/share/nginx/html;
  index index.html;

  # --- Performance ---
  sendfile on;

  # Gzip (texte, CSS/JS, SVG, JSON)
  gzip on;
  gzip_comp_level 5;
  gzip_min_length 1024;
  gzip_proxied any;
  gzip_types
    text/plain text/css application/javascript application/json
    application/xml image/svg+xml application/rss+xml;

  # Mise en cache agressive sur /assets (images, icônes, etc.)
  location /assets/ {
    access_log off;
    expires 30d;
    add_header Cache-Control "public, max-age=2592000, immutable";
    try_files $uri =404;
  }

  # Cache doux pour CSS/JS à la racine
  location ~* \.(?:css|js)$ {
    access_log off;
    expires 7d;
    add_header Cache-Control "public, max-age=604800";
    try_files $uri =404;
  }

  # Pas de cache pour l’HTML (utile quand tu mets à jour)
  location = /index.html {
    expires -1;
    add_header Cache-Control "no-store";
  }

  # Fichiers restants : retourne 404 si absent
  location / {
    try_files $uri $uri/ =404;
  }

  # --- Sécurité (headers simples & sûrs) ---
  add_header X-Content-Type-Options "nosniff" always;
  add_header X-Frame-Options "SAMEORIGIN" always;
  add_header Referrer-Policy "strict-origin-when-cross-origin" always;
  add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;

  # (Optionnel) Active un 404 custom si tu ajoutes /usr/share/nginx/html/404.html
  # error_page 404 /404.html;
}
